<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-12-08">
<meta name="description" content="Code solutions for the Hanukkah of Data challenge.">

<title>Jordan Hutchings - Solving the Hanukkah of Data Puzzles</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../img/favicon2.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QH21BBYP6K"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QH21BBYP6K', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Jordan Hutchings</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../research.html" rel="" target="">
 <span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../pdf/cv.pdf" rel="" target="">
 <span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../misc.html" rel="" target="">
 <span class="menu-text">Misc</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jjhutchi" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Solving the Hanukkah of Data Puzzles</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">Python</div>
    <div class="quarto-category">Coding Puzzles</div>
  </div>
  </div>

<div>
  <div class="description">
    Code solutions for the Hanukkah of Data challenge.
  </div>
</div>


<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 8, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>The <a href="https://hanukkah.bluebird.sh/5784/">Hanukkah of Data</a> provides eight short daily coding puzzles during Hanukkah. <!-- These puzzles are more of a  data-oriented version of the popular [Advent of Code](https://adventofcode.com/) puzzles.  --> I found this set of puzzles to be a great for improving skills in data wrangling, I initially wrote my solutions in R but these puzzles served as a good practice set for getting some reps in with data cleaning in Python.<br>
The puzzle solutions can be a little repetitive, however the solutions are not immediately apparent from the prompts, and I found myself looking forward to solving the riddles each morning. With each puzzle you unlock more of the artwork in Noah’s Rug.</p>
<p><strong>Spoiler warning</strong> – Below are my solutions to the puzzles.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ascii-art.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Noah’s Rug - the beautiful ACSII art made by the dev team</figcaption>
</figure>
</div>
<p>Lets read in the data, load our packages, and do some pre-processing.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, stringr, kableExtra)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>load_data <span class="ot">=</span> <span class="cf">function</span> (f) <span class="fu">read.csv</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>), f))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>orders       <span class="ot">=</span> <span class="fu">load_data</span>(<span class="st">"noahs-orders.csv"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>orders_items <span class="ot">=</span> <span class="fu">load_data</span>(<span class="st">"noahs-orders_items.csv"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>products     <span class="ot">=</span> <span class="fu">load_data</span>(<span class="st">"noahs-products.csv"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>customers    <span class="ot">=</span> <span class="fu">load_data</span>(<span class="st">"noahs-customers.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>orders       <span class="op">=</span> pd.read_csv(<span class="st">"data/noahs-orders.csv"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>orders_items <span class="op">=</span> pd.read_csv(<span class="st">"data/noahs-orders_items.csv"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>products     <span class="op">=</span> pd.read_csv(<span class="st">"data/noahs-products.csv"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>customers    <span class="op">=</span> pd.read_csv(<span class="st">"data/noahs-customers.csv"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> (</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  customers</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    .merge(orders, on <span class="op">=</span> <span class="st">"customerid"</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    .merge(orders_items, on <span class="op">=</span> <span class="st">"orderid"</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    .merge(products, on <span class="op">=</span> <span class="st">"sku"</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Day 1 - The Investigator
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Sarah brought a cashier over. She said, “Joe here says that one of our customers is a skilled private investigator.”</p>
<p>Joe nodded, “They showed me their business card, and that’s what it said. Skilled Private Investigator. And their phone number was their last name spelled out. I didn’t know what that meant, but apparently before there were smartphones, people had to remember phone numbers or write them down. If you wanted a phone number that was easy-to-remember, you could get a number that spelled something using the letters printed on the phone buttons: like 2 has “ABC”, and 3 “DEF”, etc. And I guess this person had done that, so if you dialed the numbers corresponding to the letters in their name, it would call their phone number!</p>
<p>“I thought that was pretty cool. But I don’t remember their name, or anything else about them for that matter. I couldn’t even tell you if they were male or female.”</p>
<p>Sarah said, “This person seems like they are skilled at investigation. I need them to find Noah’s rug before the Hanukkah dinner. I don’t know how to contact them, but apparently they shop here at Noah’s Market.”</p>
<p>She nodded at the USB drive in your hand.</p>
<p>“Can you find this investigator’s phone number?”</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>customers <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">gsub</span>(<span class="st">" jr.| iii| v| ii| iv | i"</span>, <span class="st">""</span>, <span class="fu">tolower</span>(name)),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">last_name =</span> <span class="fu">str_extract</span>(name, <span class="st">"</span><span class="sc">\\</span><span class="st">w+$"</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">name_number =</span> <span class="fu">str_replace_all</span>(last_name, <span class="st">"a|b|c"</span>, <span class="st">"2"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_replace_all</span>(<span class="st">"d|e|f"</span>, <span class="st">"3"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_replace_all</span>(<span class="st">"g|h|i"</span>, <span class="st">"4"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_replace_all</span>(<span class="st">"j|k|l"</span>, <span class="st">"5"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_replace_all</span>(<span class="st">"m|n|o"</span>, <span class="st">"6"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_replace_all</span>(<span class="st">"p|q|r|s"</span>, <span class="st">"7"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_replace_all</span>(<span class="st">"t|u|v"</span>, <span class="st">"8"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_replace_all</span>(<span class="st">"w|x|y|z"</span>, <span class="st">"9"</span>),</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">phone_number =</span> <span class="fu">gsub</span>(<span class="st">"-"</span>, <span class="st">""</span>, phone)) <span class="sc">|&gt;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name_number <span class="sc">==</span> phone_number) <span class="sc">|&gt;</span> </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, phone) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            name        phone
1 sam tannenbaum 826-636-2286</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>letter_to_phone <span class="op">=</span> {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"a"</span>: <span class="st">"2"</span>, <span class="st">"b"</span>: <span class="st">"2"</span>, <span class="st">"c"</span>: <span class="st">"2"</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"d"</span>: <span class="st">"3"</span>, <span class="st">"e"</span>: <span class="st">"3"</span>, <span class="st">"f"</span>: <span class="st">"3"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"g"</span>: <span class="st">"4"</span>, <span class="st">"h"</span>: <span class="st">"4"</span>, <span class="st">"i"</span>: <span class="st">"4"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"j"</span>: <span class="st">"5"</span>, <span class="st">"k"</span>: <span class="st">"5"</span>, <span class="st">"l"</span>: <span class="st">"5"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"m"</span>: <span class="st">"6"</span>, <span class="st">"n"</span>: <span class="st">"6"</span>, <span class="st">"o"</span>: <span class="st">"6"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"p"</span>: <span class="st">"7"</span>, <span class="st">"q"</span>: <span class="st">"7"</span>, <span class="st">"r"</span>: <span class="st">"7"</span>, <span class="st">"s"</span>: <span class="st">"7"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"t"</span>: <span class="st">"8"</span>, <span class="st">"u"</span>: <span class="st">"8"</span>, <span class="st">"v"</span>: <span class="st">"8"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"w"</span>: <span class="st">"9"</span>, <span class="st">"x"</span>: <span class="st">"9"</span>, <span class="st">"y"</span>: <span class="st">"9"</span>, <span class="st">"z"</span>: <span class="st">"9"</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, row <span class="kw">in</span> customers.iterrows():</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  name <span class="op">=</span> row[<span class="st">'name'</span>]</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  phone <span class="op">=</span> row[<span class="st">'phone'</span>]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  lname <span class="op">=</span> (</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    name</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    .lower()</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    .replace(<span class="st">"jr.| iii| v| ii| iv | i"</span>, <span class="st">""</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    .split(<span class="st">" "</span>)[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> word, replacement <span class="kw">in</span> letter_to_phone.items():</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    lname <span class="op">=</span> lname.replace(word, replacement)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="bu">str</span>(lname) <span class="op">==</span> <span class="bu">str</span>(phone).replace(<span class="st">"-"</span>, <span class="st">""</span>):</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="ss">f"Solution:</span><span class="ch">\n</span><span class="ss">Name: </span><span class="sc">{</span>name<span class="sc">}</span><span class="ch">\n</span><span class="ss">Phone: </span><span class="sc">{</span>phone<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Solution:
Name: Sam Tannenbaum
Phone: 826-636-2286</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Day 2 - The Contractor
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Thanks to your help, Sarah called the investigator that afternoon. The investigator went directly to the cleaners to see if they could get any more information about the unclaimed rug.</p>
<p>While they were out, Sarah said, “I tried cleaning the rug myself, but there was this snail on it that always seemed to leave a trail of slime behind it. I spent a few hours cleaning it, and the next day the slime trail was back.”</p>
<p>When the investigator returned, they said, “Apparently, this cleaner had a special projects program, where they outsourced challenging cleaning projects to industrious contractors. As they’re right across the street from Noah’s, they usually talked about the project over coffee and bagels at Noah’s before handing off the item to be cleaned. The contractors would pick up the tab and expense it, along with their cleaning supplies.</p>
<p>“So this rug was apparently one of those special projects. The claim ticket said ‘2017 JP’. ‘2017’ is the year the item was brought in, and ‘JP’ is the initials of the contractor.</p>
<p>“But they stopped outsourcing a few years ago, and don’t have contact information for any of these workers anymore.”</p>
<p>Sarah first seemed hopeless, and then glanced at the USB drive you had just put back in her hand. She said, “I know it’s a long shot, but is there any chance you could find their phone number?”</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>bagel_skus <span class="ot">=</span> products <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"bagel"</span>, <span class="fu">tolower</span>(desc))) <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sku)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>bagel_order_ids <span class="ot">=</span> orders_items <span class="sc">|&gt;</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sku <span class="sc">%in%</span> bagel_skus)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>bagel_order_customers <span class="ot">=</span> orders <span class="sc">|&gt;</span> </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(shipped)) <span class="sc">|&gt;</span> </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(orderid <span class="sc">%in%</span> bagel_order_ids<span class="sc">$</span>orderid, </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>         year <span class="sc">==</span> <span class="dv">2017</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(customerid)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>customers <span class="sc">|&gt;</span> </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(customerid <span class="sc">%in%</span> bagel_order_customers) <span class="sc">|&gt;</span> </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">gsub</span>(<span class="st">" jr.| iii| v| ii| iv | i"</span>, <span class="st">""</span>, <span class="fu">tolower</span>(name)),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">last_name =</span> <span class="fu">str_extract</span>(name, <span class="st">"</span><span class="sc">\\</span><span class="st">w+$"</span>), </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">first_name =</span> <span class="fu">str_extract</span>(name, <span class="st">"^</span><span class="sc">\\</span><span class="st">w+"</span>), </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">initals =</span> <span class="fu">paste0</span>(<span class="fu">str_sub</span>(first_name, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_sub</span>(last_name, <span class="dv">1</span>, <span class="dv">1</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(initals <span class="sc">==</span> <span class="st">"jp"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, phone)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             name        phone
1 joshua peterson 332-274-4185</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cust <span class="op">=</span> data[data[<span class="st">"desc"</span>].<span class="bu">str</span>.contains(<span class="st">"bagel"</span>, case <span class="op">=</span> <span class="va">False</span>) <span class="op">&amp;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>            data[<span class="st">"shipped"</span>].<span class="bu">str</span>.contains(<span class="st">"2017"</span>)]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, row <span class="kw">in</span> cust.iterrows():</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  name <span class="op">=</span> row[<span class="st">'name'</span>]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  phone <span class="op">=</span> row[<span class="st">'phone'</span>]</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  names <span class="op">=</span> (</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    name</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>      .lower()</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>      .replace(<span class="st">"jr.| iii| v| ii| iv | i"</span>, <span class="st">""</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>      .split(<span class="st">" "</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  initals <span class="op">=</span> names[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> names[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> initals <span class="op">==</span> <span class="st">"jp"</span>:</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="ss">f"Solution:</span><span class="ch">\n</span><span class="ss">Name: </span><span class="sc">{</span>name<span class="sc">}</span><span class="ch">\n</span><span class="ss">Phone: </span><span class="sc">{</span>phone<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Solution:
Name: Joshua Peterson
Phone: 332-274-4185</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Day 3 - The Neighbor
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Sarah and the investigator were very impressed with your data skills, as you were able to figure out the phone number of the contractor. They called up the cleaning contractor straight away and asked about the rug.</p>
<p>“Oh, yeah, I did some special projects for them a few years ago. I remember that rug unfortunately. I managed to clean one section, which revealed a giant spider that startled me whenever I tried to work on it.</p>
<p>“I already had a fear of spiders before this, but this spider was so realistic that I had a hard time making any more progress. I kept expecting the cleaners would call for the rug, but they never did. I felt so bad about it, I couldn’t face them, and of course they never gave me another project.</p>
<p>“At last I couldn’t deal with the rug taking up my whole bathtub, so I gave it to this guy who lived in my neighborhood. He said that he was naturally intuitive because he was a Cancer born in the year of the Rabbit, so maybe he was able to clean it.</p>
<p>“I don’t remember his name. Last time I saw him, he was leaving the subway and carrying a bag from Noah’s. I swore I saw a spider on his hat.”</p>
<p>Can you find the phone number of the person that the contractor gave the rug to?</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>rabbit_years <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1939</span>, <span class="dv">1951</span>, <span class="dv">1963</span>, <span class="dv">1975</span>, <span class="dv">1987</span>, <span class="dv">1999</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>neighborhood <span class="ot">=</span> customers <span class="sc">|&gt;</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(phone <span class="sc">==</span> <span class="st">"332-274-4185"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(<span class="st">"citystatezip"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>customers <span class="sc">|&gt;</span> </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(birthdate), </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">month =</span> lubridate<span class="sc">::</span><span class="fu">month</span>(birthdate), </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">day =</span> lubridate<span class="sc">::</span><span class="fu">day</span>(birthdate)) <span class="sc">|&gt;</span> </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> rabbit_years, </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>         month <span class="sc">==</span> <span class="dv">6</span> <span class="sc">&amp;</span> day <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">|</span> month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">22</span>, </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>         citystatezip <span class="sc">==</span> neighborhood) <span class="sc">|&gt;</span> </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, phone)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           name        phone
1 Robert Morton 917-288-9635</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>rabbit_years <span class="op">=</span> [<span class="dv">1939</span>, <span class="dv">1951</span>, <span class="dv">1963</span>, <span class="dv">1975</span>, <span class="dv">1987</span>, <span class="dv">1999</span>]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>neighborhood <span class="op">=</span> customers[customers[<span class="st">"phone"</span>] <span class="op">==</span> <span class="st">"332-274-4185"</span>][<span class="st">"citystatezip"</span>].iloc[<span class="dv">0</span>]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"birthdate"</span>] <span class="op">=</span> pd.to_datetime(data[<span class="st">"birthdate"</span>])</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>birth_month <span class="op">=</span> data[<span class="st">"birthdate"</span>].dt.month</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>birth_day <span class="op">=</span> data[<span class="st">"birthdate"</span>].dt.day</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>birth_year <span class="op">=</span> data[<span class="st">"birthdate"</span>].dt.year</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>june_f <span class="op">=</span> (birth_month <span class="op">==</span> <span class="dv">6</span>) <span class="op">&amp;</span> (birth_day <span class="op">&gt;=</span> <span class="dv">21</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>july_f <span class="op">=</span> (birth_month <span class="op">==</span> <span class="dv">7</span>) <span class="op">&amp;</span> (birth_day <span class="op">&lt;=</span> <span class="dv">22</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>rabbit_year_f <span class="op">=</span> birth_year.isin(rabbit_years)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>neighborhood_f <span class="op">=</span> data[<span class="st">"citystatezip"</span>] <span class="op">==</span> neighborhood</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>conditions <span class="op">=</span> (june_f <span class="op">|</span> july_f) <span class="op">&amp;</span> rabbit_year_f <span class="op">&amp;</span> neighborhood_f</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the filter</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>data[conditions][[<span class="st">"name"</span>, <span class="st">"phone"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 name         phone
198918  Robert Morton  917-288-9635</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Day 4 - The Early Bird
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The investigator called the phone number you found and left a message, and a man soon called back:</p>
<p>“Wow, that was years ago! It was quite an elegant tapestry.</p>
<p>“It took a lot of patience, but I did manage to get the dirt out of one section, which uncovered a superb owl. I put it up on my wall, and sometimes at night I swear I could hear the owl hooting.</p>
<p>“A few weeks later my bike chain broke on the way home, and I needed to get it fixed before work the next day. Thankfully, this woman I met on Tinder came over at 5am with her bike chain repair kit and some pastries from Noah’s. Apparently she liked to get up before dawn and claim the first pastries that came out of the oven.</p>
<p>“I didn’t have any money or I would’ve paid her for her trouble. She really liked the tapestry, though, so I wound up giving it to her.</p>
<p>“I don’t remember her name or anything else about her.”</p>
<p>Can you find the bicycle fixer’s phone number?</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>bakery_skus <span class="ot">=</span> products <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"bky"</span>, <span class="fu">tolower</span>(sku))) <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"bagel"</span>, <span class="fu">tolower</span>(desc)))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>bakery_order_items <span class="ot">=</span> orders_items <span class="sc">|&gt;</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sku <span class="sc">%in%</span> bakery_skus<span class="sc">$</span>sku, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>         qty <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(<span class="st">"orderid"</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>bakery_orders_customers <span class="ot">=</span> orders <span class="sc">|&gt;</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(orderid <span class="sc">%in%</span> bakery_order_items, </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>         lubridate<span class="sc">::</span><span class="fu">hour</span>(shipped) <span class="sc">&lt;</span> <span class="dv">5</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>         ordered <span class="sc">==</span> shipped)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>customers <span class="sc">|&gt;</span> </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(customerid <span class="sc">%in%</span> bakery_orders_customers<span class="sc">$</span>customerid) <span class="sc">|&gt;</span> </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, phone)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          name        phone
1 Renee Harmon 607-231-3605</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"shipped"</span>] <span class="op">=</span> pd.to_datetime(data[<span class="st">"shipped"</span>])</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"ordered"</span>] <span class="op">=</span> pd.to_datetime(data[<span class="st">"ordered"</span>])</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>sku_f <span class="op">=</span> data[<span class="st">"sku"</span>].<span class="bu">str</span>.contains(<span class="st">"bky"</span>, case<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>hour_f <span class="op">=</span> data[<span class="st">"shipped"</span>].dt.hour <span class="op">&lt;</span> <span class="dv">5</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>in_store_f <span class="op">=</span> data[<span class="st">"shipped"</span>] <span class="op">==</span> data[<span class="st">"ordered"</span>]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>qty_f <span class="op">=</span> data[<span class="st">"qty"</span>] <span class="op">&gt;</span> <span class="dv">1</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>conditions <span class="op">=</span> sku_f <span class="op">&amp;</span> hour_f <span class="op">&amp;</span> in_store_f <span class="op">&amp;</span> qty_f</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>data[conditions][[<span class="st">"name"</span>, <span class="st">"phone"</span>]].drop_duplicates()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               name         phone
18500  Renee Harmon  607-231-3605</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Day 5 - The Cat Lady
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>“Yes, I did have that tapestry for a little bit. I even cleaned a blotchy section that turned out to be a friendly koala.</p>
<p>“But it was still really dirty, so when I was going through a Marie Kondo phase, I decided it wasn’t sparking joy anymore.</p>
<p>“I listed it on Freecycle, and a woman in Staten Island came to pick it up. She was wearing a ‘Noah’s Market’ sweatshirt, and it was just covered in cat hair. When I suggested that a clowder of cats might ruin such a fine tapestry, she looked at me funny. She said “I only have ten or eleven cats, and anyway they are getting quite old now, so I doubt they’d care about some old rug.”</p>
<p>“It took her 20 minutes to stuff the tapestry into some plastic bags she brought because it was raining. I spent the evening cleaning my apartment.”</p>
<p>What’s the phone number of the woman from Freecycle?</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>old_cat_food <span class="ot">=</span> products <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"senior cat"</span>, <span class="fu">tolower</span>(desc))) <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(<span class="st">"sku"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>cat_order_items <span class="ot">=</span> orders_items <span class="sc">|&gt;</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sku <span class="sc">%in%</span> old_cat_food, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>         qty <span class="sc">==</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(<span class="st">"orderid"</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>orders <span class="sc">|&gt;</span> </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(orderid <span class="sc">%in%</span> cat_order_items) <span class="sc">|&gt;</span> </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(customers, <span class="at">by =</span> <span class="st">"customerid"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, phone) <span class="sc">|&gt;</span> </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           name        phone
1 Nicole Wilson 631-507-6048</code></pre>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>cat_desc <span class="op">=</span> data[<span class="st">"desc"</span>].<span class="bu">str</span>.contains(<span class="st">"senior cat"</span>, case<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>cat_qty <span class="op">=</span> data[<span class="st">"qty"</span>] <span class="op">==</span> <span class="dv">10</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>data[cat_desc <span class="op">&amp;</span> cat_qty][[<span class="st">"name"</span>, <span class="st">"phone"</span>]].drop_duplicates()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               name         phone
6140  Nicole Wilson  631-507-6048</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Day 6 - The Bargain Hunter
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>“Why yes, I did have that rug for a little while in my living room! My cats can’t see a thing but they sure chased after the squirrel on it like it was dancing in front of their noses.</p>
<p>“It was a nice rug and they were surely going to ruin it, so I gave it to my cousin, who was moving into a new place that had wood floors.</p>
<p>“She refused to buy a new rug for herself–she said they were way too expensive. She’s always been very frugal, and she clips every coupon and shops every sale at Noah’s Market. In fact I like to tease her that Noah actually loses money whenever she comes in the store.</p>
<p>“I think she’s been taking it too far lately though. Once the subway fare increased, she stopped coming to visit me. And she’s really slow to respond to my texts. I hope she remembers to invite me to the family reunion next year.”</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check which prices are offered below wholesale cost </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>orders_below_cost <span class="ot">=</span> orders_items <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(products <span class="sc">|&gt;</span> <span class="fu">select</span>(wholesale_cost, sku), </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"sku"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sale =</span> unit_price <span class="sc">&lt;</span> wholesale_cost) <span class="sc">|&gt;</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sale) <span class="sc">|&gt;</span> </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(orderid)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>orders <span class="sc">|&gt;</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(orderid <span class="sc">%in%</span> orders_below_cost) <span class="sc">|&gt;</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(customerid) <span class="sc">|&gt;</span> </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">num_purchases =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(num_purchases)) <span class="sc">|&gt;</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(customers <span class="sc">|&gt;</span> <span class="fu">select</span>(customerid, name, phone), <span class="at">by =</span> <span class="st">"customerid"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_purchases <span class="sc">==</span> <span class="fu">max</span>(num_purchases)) <span class="sc">|&gt;</span> </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, phone)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  name        phone       
  &lt;chr&gt;       &lt;chr&gt;       
1 Sherri Long 585-838-9161</code></pre>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>below_cost <span class="op">=</span> data[<span class="st">"unit_price"</span>] <span class="op">&lt;</span> data[<span class="st">"wholesale_cost"</span>]</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>counts <span class="op">=</span> (</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  data[below_cost]</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  .groupby([<span class="st">"name"</span>, <span class="st">"phone"</span>])</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  .agg(n_below_cost <span class="op">=</span> pd.NamedAgg(column<span class="op">=</span><span class="st">"orderid"</span>, aggfunc<span class="op">=</span><span class="st">"nunique"</span>))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>counts[counts[<span class="st">"n_below_cost"</span>] <span class="op">==</span> counts[<span class="st">"n_below_cost"</span>].<span class="bu">max</span>()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          n_below_cost
name        phone                     
Sherri Long 585-838-9161            31</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Day 7 - The Meet Cute
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>“Oh that tapestry, with the colorful toucan on it! I’ll tell you what happened to it.</p>
<p>“One day, I was at Noah’s Market, and I was just about to leave when someone behind me said ‘Miss! You dropped something!’</p>
<p>“Well I turned around to see this cute guy holding an item I had bought. He said, ‘I got the same thing!’ We laughed about it and wound up swapping items because I wanted the color he got. We had a moment when our eyes met and my heart stopped for a second. I asked him to get some food with me and we spent the rest of the day together.</p>
<p>“Before long I moved into his place, but the romance faded quickly, as he wasn’t the prince I imagined. I left abruptly one night, forgetting the tapestry on his wall. But by then, it symbolized our love, and I wanted nothing more to do with it. For all I know, he still has it.”</p>
<p>Can you figure out her ex-boyfriend’s phone number?</p>
<p>Can you find her cousin’s phone number?</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>day_6_phone <span class="ot">=</span> <span class="st">"585-838-9161"</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>past_customer <span class="ot">=</span> customers <span class="sc">|&gt;</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(phone <span class="sc">==</span> day_6_phone) <span class="sc">|&gt;</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(customerid)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>color_purchases <span class="ot">=</span> products <span class="sc">|&gt;</span> </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(orders_items <span class="sc">|&gt;</span> <span class="fu">select</span>(orderid, sku), <span class="at">by =</span> <span class="st">"sku"</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(orders <span class="sc">|&gt;</span> <span class="fu">select</span>(orderid, customerid, </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>                             ordered, shipped), </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"orderid"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"col"</span>, <span class="fu">tolower</span>(sku)), </span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>         ordered <span class="sc">==</span> shipped) <span class="sc">|&gt;</span> </span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">item =</span> <span class="fu">str_extract</span>(desc, <span class="st">"</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">s</span><span class="sc">\\</span><span class="st">w+"</span>), </span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="fu">str_extract</span>(desc, <span class="st">"</span><span class="sc">\\</span><span class="st">(</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">)"</span>), </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">(|</span><span class="sc">\\</span><span class="st">)"</span>, <span class="st">""</span>, colour))</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>gf_purchases <span class="ot">=</span> color_purchases <span class="sc">|&gt;</span> </span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(customerid <span class="sc">==</span> past_customer, </span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>         <span class="fu">grepl</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">("</span>, desc)) </span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>search_for_purchases <span class="ot">=</span> <span class="cf">function</span>(dat) {</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  gf_item <span class="ot">=</span> dat<span class="sc">$</span>item</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>  gf_colour <span class="ot">=</span> dat<span class="sc">$</span>colour</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>  gf_time <span class="ot">=</span> dat<span class="sc">$</span>ordered</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">=</span> color_purchases <span class="sc">|&gt;</span> </span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(item <span class="sc">==</span> gf_item <span class="sc">&amp;</span> colour <span class="sc">!=</span> gf_colour, </span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>           <span class="fu">abs</span>(<span class="fu">difftime</span>(ordered, gf_time, <span class="at">units =</span> <span class="st">"mins"</span>)) <span class="sc">&lt;</span> <span class="dv">10</span>)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a><span class="co"># loop through girlfriend's purchases</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(gf_purchases), <span class="cf">function</span>(i) {</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">search_for_purchases</span>(gf_purchases[i, ])</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">|&gt;</span> </span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">|&gt;</span> </span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(customerid) <span class="sc">|&gt;</span> </span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(customers, <span class="at">by =</span> <span class="st">"customerid"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(customerid, name, phone)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  customerid         name        phone
1       5783 Carlos Myers 838-335-7157</code></pre>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>day_6_phone <span class="op">=</span> <span class="st">"585-838-9161"</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"color"</span>] <span class="op">=</span> data[<span class="st">"desc"</span>].<span class="bu">str</span>.extract(<span class="vs">r"\((\w+)\)"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"item"</span>] <span class="op">=</span> data[<span class="st">"desc"</span>].<span class="bu">str</span>.extract(<span class="vs">r"(\w+\s\w+)"</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"ordered"</span>] <span class="op">=</span> pd.to_datetime(data[<span class="st">"ordered"</span>])</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>color_data <span class="op">=</span> data[data[<span class="st">"sku"</span>].<span class="bu">str</span>.contains(<span class="st">"col"</span>, case<span class="op">=</span><span class="va">False</span>)]</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>gf_items <span class="op">=</span> color_data[color_data[<span class="st">"phone"</span>] <span class="op">==</span> day_6_phone]</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> color, item, time <span class="kw">in</span> <span class="bu">zip</span>(gf_items[<span class="st">"color"</span>], </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                             gf_items[<span class="st">"item"</span>], </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                             gf_items[<span class="st">"ordered"</span>]):</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    time_delta <span class="op">=</span> color_data[<span class="st">"ordered"</span>] <span class="op">-</span> time</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    diff_color <span class="op">=</span> color_data[<span class="st">"color"</span>] <span class="op">!=</span> color</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    same_item <span class="op">=</span> color_data[<span class="st">"item"</span>] <span class="op">==</span> item</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    same_time <span class="op">=</span> <span class="bu">abs</span>(time_delta) <span class="op">&lt;</span> pd.Timedelta(<span class="st">"10 minutes"</span>)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    candidate <span class="op">=</span> same_time <span class="op">&amp;</span> same_item <span class="op">&amp;</span> diff_color</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> candidate.<span class="bu">any</span>():</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>      color_data[candidate][[<span class="st">"name"</span>, <span class="st">"phone"</span>]].drop_duplicates()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                name         phone
324740  Carlos Myers  838-335-7157</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Day 8 - The Collector
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>“Oh that damned woman! She moved in, clogged my bathtub, left her coupons all over the kitchen, and then just vanished one night without leaving so much as a note.</p>
<p>Except she did leave behind that nasty carpet. I spent months cleaning one corner, only to discover a snake hiding in the branches! I knew then that she was never coming back, and I had to get it out of my sight.</p>
<p>“Well, I don’t have any storage here, and it didn’t seem right to sell it, so I gave it to my sister. She wound up getting a newer and more expensive carpet, so she gave it to an acquaintance of hers who collects all sorts of junk. Apparently he owns an entire set of Noah’s collectibles! He probably still has the carpet, even.</p>
<p>“My sister is away for the holidays, but I can have her call you in a few weeks.”</p>
<p>The family dinner is tonight! Can you find the collector’s phone number in time?</p>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find customer with the most collectible (col) purchases</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>products <span class="sc">|&gt;</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"col"</span>, <span class="fu">tolower</span>(sku))) <span class="sc">|&gt;</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(orders_items <span class="sc">|&gt;</span> <span class="fu">select</span>(orderid, sku), <span class="at">by =</span> <span class="st">"sku"</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(orders <span class="sc">|&gt;</span> <span class="fu">select</span>(orderid, customerid), <span class="at">by =</span> <span class="st">"orderid"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(customerid) <span class="sc">|&gt;</span> </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">|&gt;</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(customers <span class="sc">|&gt;</span> <span class="fu">select</span>(customerid, name, phone), <span class="at">by =</span> <span class="st">"customerid"</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">==</span> <span class="fu">max</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, phone)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  name        phone       
  &lt;chr&gt;       &lt;chr&gt;       
1 James Smith 212-547-3518</code></pre>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>collectables <span class="op">=</span> data[data[<span class="st">"sku"</span>].<span class="bu">str</span>.contains(<span class="st">"col"</span>, case<span class="op">=</span><span class="va">False</span>)]</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    collectables</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">"name"</span>, <span class="st">"phone"</span>])</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    .agg(n_collectables<span class="op">=</span>pd.NamedAgg(column<span class="op">=</span><span class="st">"orderid"</span>, aggfunc<span class="op">=</span><span class="st">"nunique"</span>))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    .sort_values(<span class="st">"n_collectables"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    .head(<span class="dv">1</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          n_collectables
name        phone                       
James Smith 212-547-3518             109</code></pre>
</div>
</div>
</div>
</div>
</div>
<!-- ## My solve statistics  -->
<!-- I enjoyed working through the puzzles. While there is meant to be an increase in difficulty each day, I found day 7 to be by far the most difficult. The rest of the days I found the biggest challenge finding the key clue within the puzzle prompt.  -->
<!-- | Puzzle | Solve Time | # Attempts | -->
<!-- | :---: | :---: | :---: |  -->
<!-- | 0 |  39 seconds | 2 | -->
<!-- | 1 |  13 minutes | 2 | -->
<!-- | 2 | 10 minutes | 1 |  -->
<!-- | 3 |  13 minutes | 1 | -->
<!-- | 4 |  14 minutes | 1 |  -->
<!-- | 5 |  13 minutes | 1 | -->
<!-- | 6 |  13 minutes | 1 | -->
<!-- | 7 |  70 minutes | 2 | -->
<!-- | 8 |  4 minutes | 1 | -->


<!-- -->


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb35" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Solving the Hanukkah of Data Puzzles"</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 'December 8, 2023'</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> source</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> Code solutions for the Hanukkah of Data challenge.</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co">  - R</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co">  - Python</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co">  - Coding Puzzles</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: false</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>The <span class="co">[</span><span class="ot">Hanukkah of Data</span><span class="co">](https://hanukkah.bluebird.sh/5784/)</span> provides eight short daily coding puzzles during Hanukkah. </span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- These puzzles are more of a  data-oriented version of the popular [Advent of Code](https://adventofcode.com/) puzzles.  --&gt;</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>I found this set of puzzles to be a great for improving skills in data wrangling, I initially wrote my solutions in R but these puzzles served as a good practice set for getting some reps in with data cleaning in Python.  </span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>The puzzle solutions can be a little repetitive, however the solutions are not immediately apparent from the prompts, and I found myself looking forward to solving the riddles each morning. With each puzzle you unlock more of the artwork in Noah's Rug. </span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>**Spoiler warning** -- Below are my solutions to the puzzles. </span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="al">![Noah's Rug - the beautiful ACSII art made by the dev team](ascii-art.png)</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>Lets read in the data, load our packages, and do some pre-processing. </span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>::: panel-tabset </span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a><span class="fu">### R </span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, stringr, kableExtra)</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>load_data <span class="ot">=</span> <span class="cf">function</span> (f) <span class="fu">read.csv</span>(<span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>), f))</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>orders       <span class="ot">=</span> <span class="fu">load_data</span>(<span class="st">"noahs-orders.csv"</span>)</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>orders_items <span class="ot">=</span> <span class="fu">load_data</span>(<span class="st">"noahs-orders_items.csv"</span>)</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>products     <span class="ot">=</span> <span class="fu">load_data</span>(<span class="st">"noahs-products.csv"</span>)</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>customers    <span class="ot">=</span> <span class="fu">load_data</span>(<span class="st">"noahs-customers.csv"</span>)</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>orders       <span class="op">=</span> pd.read_csv(<span class="st">"data/noahs-orders.csv"</span>)</span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>orders_items <span class="op">=</span> pd.read_csv(<span class="st">"data/noahs-orders_items.csv"</span>)</span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>products     <span class="op">=</span> pd.read_csv(<span class="st">"data/noahs-products.csv"</span>)</span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>customers    <span class="op">=</span> pd.read_csv(<span class="st">"data/noahs-customers.csv"</span>)</span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> (</span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>  customers</span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>    .merge(orders, on <span class="op">=</span> <span class="st">"customerid"</span>)</span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>    .merge(orders_items, on <span class="op">=</span> <span class="st">"orderid"</span>)</span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>    .merge(products, on <span class="op">=</span> <span class="st">"sku"</span>)</span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>::: {.callout collapse="true"}</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a><span class="fu">### Day 1 - The Investigator</span></span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>Sarah brought a cashier over. She said, “Joe here says that one of our customers is a skilled private investigator.”</span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>Joe nodded, “They showed me their business card, and that’s what it said. Skilled Private Investigator. And their phone number was their last name spelled out. I didn’t know what that meant, but apparently before there were smartphones, people had to remember phone numbers or write them down. If you wanted a phone number that was easy-to-remember, you could get a number that spelled something using the letters printed on the phone buttons: like 2 has “ABC”, and 3 “DEF”, etc. And I guess this person had done that, so if you dialed the numbers corresponding to the letters in their name, it would call their phone number!</span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>“I thought that was pretty cool. But I don’t remember their name, or anything else about them for that matter. I couldn’t even tell you if they were male or female.”</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>Sarah said, “This person seems like they are skilled at investigation. I need them to find Noah’s rug before the Hanukkah dinner. I don’t know how to contact them, but apparently they shop here at Noah’s Market.”</span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>She nodded at the USB drive in your hand.</span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>“Can you find this investigator’s phone number?”</span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a>::: panel-tabset </span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a>customers <span class="sc">|&gt;</span></span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">gsub</span>(<span class="st">" jr.| iii| v| ii| iv | i"</span>, <span class="st">""</span>, <span class="fu">tolower</span>(name)),</span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a>         <span class="at">last_name =</span> <span class="fu">str_extract</span>(name, <span class="st">"</span><span class="sc">\\</span><span class="st">w+$"</span>),</span>
<span id="cb35-92"><a href="#cb35-92" aria-hidden="true" tabindex="-1"></a>         <span class="at">name_number =</span> <span class="fu">str_replace_all</span>(last_name, <span class="st">"a|b|c"</span>, <span class="st">"2"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-93"><a href="#cb35-93" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_replace_all</span>(<span class="st">"d|e|f"</span>, <span class="st">"3"</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-94"><a href="#cb35-94" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_replace_all</span>(<span class="st">"g|h|i"</span>, <span class="st">"4"</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-95"><a href="#cb35-95" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_replace_all</span>(<span class="st">"j|k|l"</span>, <span class="st">"5"</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-96"><a href="#cb35-96" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_replace_all</span>(<span class="st">"m|n|o"</span>, <span class="st">"6"</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-97"><a href="#cb35-97" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_replace_all</span>(<span class="st">"p|q|r|s"</span>, <span class="st">"7"</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-98"><a href="#cb35-98" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_replace_all</span>(<span class="st">"t|u|v"</span>, <span class="st">"8"</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-99"><a href="#cb35-99" aria-hidden="true" tabindex="-1"></a>            <span class="fu">str_replace_all</span>(<span class="st">"w|x|y|z"</span>, <span class="st">"9"</span>),</span>
<span id="cb35-100"><a href="#cb35-100" aria-hidden="true" tabindex="-1"></a>         <span class="at">phone_number =</span> <span class="fu">gsub</span>(<span class="st">"-"</span>, <span class="st">""</span>, phone)) <span class="sc">|&gt;</span></span>
<span id="cb35-101"><a href="#cb35-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name_number <span class="sc">==</span> phone_number) <span class="sc">|&gt;</span> </span>
<span id="cb35-102"><a href="#cb35-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, phone) </span>
<span id="cb35-103"><a href="#cb35-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-104"><a href="#cb35-104" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-105"><a href="#cb35-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-106"><a href="#cb35-106" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python</span></span>
<span id="cb35-107"><a href="#cb35-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-110"><a href="#cb35-110" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb35-111"><a href="#cb35-111" aria-hidden="true" tabindex="-1"></a>letter_to_phone <span class="op">=</span> {</span>
<span id="cb35-112"><a href="#cb35-112" aria-hidden="true" tabindex="-1"></a>  <span class="st">"a"</span>: <span class="st">"2"</span>, <span class="st">"b"</span>: <span class="st">"2"</span>, <span class="st">"c"</span>: <span class="st">"2"</span>,</span>
<span id="cb35-113"><a href="#cb35-113" aria-hidden="true" tabindex="-1"></a>  <span class="st">"d"</span>: <span class="st">"3"</span>, <span class="st">"e"</span>: <span class="st">"3"</span>, <span class="st">"f"</span>: <span class="st">"3"</span>,</span>
<span id="cb35-114"><a href="#cb35-114" aria-hidden="true" tabindex="-1"></a>  <span class="st">"g"</span>: <span class="st">"4"</span>, <span class="st">"h"</span>: <span class="st">"4"</span>, <span class="st">"i"</span>: <span class="st">"4"</span>,</span>
<span id="cb35-115"><a href="#cb35-115" aria-hidden="true" tabindex="-1"></a>  <span class="st">"j"</span>: <span class="st">"5"</span>, <span class="st">"k"</span>: <span class="st">"5"</span>, <span class="st">"l"</span>: <span class="st">"5"</span>,</span>
<span id="cb35-116"><a href="#cb35-116" aria-hidden="true" tabindex="-1"></a>  <span class="st">"m"</span>: <span class="st">"6"</span>, <span class="st">"n"</span>: <span class="st">"6"</span>, <span class="st">"o"</span>: <span class="st">"6"</span>,</span>
<span id="cb35-117"><a href="#cb35-117" aria-hidden="true" tabindex="-1"></a>  <span class="st">"p"</span>: <span class="st">"7"</span>, <span class="st">"q"</span>: <span class="st">"7"</span>, <span class="st">"r"</span>: <span class="st">"7"</span>, <span class="st">"s"</span>: <span class="st">"7"</span>,</span>
<span id="cb35-118"><a href="#cb35-118" aria-hidden="true" tabindex="-1"></a>  <span class="st">"t"</span>: <span class="st">"8"</span>, <span class="st">"u"</span>: <span class="st">"8"</span>, <span class="st">"v"</span>: <span class="st">"8"</span>,</span>
<span id="cb35-119"><a href="#cb35-119" aria-hidden="true" tabindex="-1"></a>  <span class="st">"w"</span>: <span class="st">"9"</span>, <span class="st">"x"</span>: <span class="st">"9"</span>, <span class="st">"y"</span>: <span class="st">"9"</span>, <span class="st">"z"</span>: <span class="st">"9"</span></span>
<span id="cb35-120"><a href="#cb35-120" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-121"><a href="#cb35-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-122"><a href="#cb35-122" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, row <span class="kw">in</span> customers.iterrows():</span>
<span id="cb35-123"><a href="#cb35-123" aria-hidden="true" tabindex="-1"></a>  name <span class="op">=</span> row[<span class="st">'name'</span>]</span>
<span id="cb35-124"><a href="#cb35-124" aria-hidden="true" tabindex="-1"></a>  phone <span class="op">=</span> row[<span class="st">'phone'</span>]</span>
<span id="cb35-125"><a href="#cb35-125" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-126"><a href="#cb35-126" aria-hidden="true" tabindex="-1"></a>  lname <span class="op">=</span> (</span>
<span id="cb35-127"><a href="#cb35-127" aria-hidden="true" tabindex="-1"></a>    name</span>
<span id="cb35-128"><a href="#cb35-128" aria-hidden="true" tabindex="-1"></a>    .lower()</span>
<span id="cb35-129"><a href="#cb35-129" aria-hidden="true" tabindex="-1"></a>    .replace(<span class="st">"jr.| iii| v| ii| iv | i"</span>, <span class="st">""</span>)</span>
<span id="cb35-130"><a href="#cb35-130" aria-hidden="true" tabindex="-1"></a>    .split(<span class="st">" "</span>)[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb35-131"><a href="#cb35-131" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-132"><a href="#cb35-132" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-133"><a href="#cb35-133" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> word, replacement <span class="kw">in</span> letter_to_phone.items():</span>
<span id="cb35-134"><a href="#cb35-134" aria-hidden="true" tabindex="-1"></a>    lname <span class="op">=</span> lname.replace(word, replacement)</span>
<span id="cb35-135"><a href="#cb35-135" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-136"><a href="#cb35-136" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="bu">str</span>(lname) <span class="op">==</span> <span class="bu">str</span>(phone).replace(<span class="st">"-"</span>, <span class="st">""</span>):</span>
<span id="cb35-137"><a href="#cb35-137" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="ss">f"Solution:</span><span class="ch">\n</span><span class="ss">Name: </span><span class="sc">{</span>name<span class="sc">}</span><span class="ch">\n</span><span class="ss">Phone: </span><span class="sc">{</span>phone<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb35-138"><a href="#cb35-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-139"><a href="#cb35-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-140"><a href="#cb35-140" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-141"><a href="#cb35-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-142"><a href="#cb35-142" aria-hidden="true" tabindex="-1"></a>::: {.callout collapse="true"}</span>
<span id="cb35-143"><a href="#cb35-143" aria-hidden="true" tabindex="-1"></a><span class="fu">### Day  2 - The Contractor</span></span>
<span id="cb35-144"><a href="#cb35-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-145"><a href="#cb35-145" aria-hidden="true" tabindex="-1"></a>Thanks to your help, Sarah called the investigator that afternoon. The investigator went directly to the cleaners to see if they could get any more information about the unclaimed rug.</span>
<span id="cb35-146"><a href="#cb35-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-147"><a href="#cb35-147" aria-hidden="true" tabindex="-1"></a>While they were out, Sarah said, “I tried cleaning the rug myself, but there was this snail on it that always seemed to leave a trail of slime behind it. I spent a few hours cleaning it, and the next day the slime trail was back.”</span>
<span id="cb35-148"><a href="#cb35-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-149"><a href="#cb35-149" aria-hidden="true" tabindex="-1"></a>When the investigator returned, they said, “Apparently, this cleaner had a special projects program, where they outsourced challenging cleaning projects to industrious contractors. As they’re right across the street from Noah’s, they usually talked about the project over coffee and bagels at Noah’s before handing off the item to be cleaned. The contractors would pick up the tab and expense it, along with their cleaning supplies.</span>
<span id="cb35-150"><a href="#cb35-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-151"><a href="#cb35-151" aria-hidden="true" tabindex="-1"></a>“So this rug was apparently one of those special projects. The claim ticket said ‘2017 JP’. ‘2017’ is the year the item was brought in, and ‘JP’ is the initials of the contractor.</span>
<span id="cb35-152"><a href="#cb35-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-153"><a href="#cb35-153" aria-hidden="true" tabindex="-1"></a>“But they stopped outsourcing a few years ago, and don’t have contact information for any of these workers anymore.”</span>
<span id="cb35-154"><a href="#cb35-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-155"><a href="#cb35-155" aria-hidden="true" tabindex="-1"></a>Sarah first seemed hopeless, and then glanced at the USB drive you had just put back in her hand. She said, “I know it’s a long shot, but is there any chance you could find their phone number?”</span>
<span id="cb35-156"><a href="#cb35-156" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-157"><a href="#cb35-157" aria-hidden="true" tabindex="-1"></a>::: panel-tabset </span>
<span id="cb35-158"><a href="#cb35-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-159"><a href="#cb35-159" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb35-160"><a href="#cb35-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-163"><a href="#cb35-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-164"><a href="#cb35-164" aria-hidden="true" tabindex="-1"></a>bagel_skus <span class="ot">=</span> products <span class="sc">|&gt;</span> </span>
<span id="cb35-165"><a href="#cb35-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"bagel"</span>, <span class="fu">tolower</span>(desc))) <span class="sc">|&gt;</span> </span>
<span id="cb35-166"><a href="#cb35-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sku)</span>
<span id="cb35-167"><a href="#cb35-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-168"><a href="#cb35-168" aria-hidden="true" tabindex="-1"></a>bagel_order_ids <span class="ot">=</span> orders_items <span class="sc">|&gt;</span> </span>
<span id="cb35-169"><a href="#cb35-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sku <span class="sc">%in%</span> bagel_skus)</span>
<span id="cb35-170"><a href="#cb35-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-171"><a href="#cb35-171" aria-hidden="true" tabindex="-1"></a>bagel_order_customers <span class="ot">=</span> orders <span class="sc">|&gt;</span> </span>
<span id="cb35-172"><a href="#cb35-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(shipped)) <span class="sc">|&gt;</span> </span>
<span id="cb35-173"><a href="#cb35-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(orderid <span class="sc">%in%</span> bagel_order_ids<span class="sc">$</span>orderid, </span>
<span id="cb35-174"><a href="#cb35-174" aria-hidden="true" tabindex="-1"></a>         year <span class="sc">==</span> <span class="dv">2017</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-175"><a href="#cb35-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(customerid)</span>
<span id="cb35-176"><a href="#cb35-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-177"><a href="#cb35-177" aria-hidden="true" tabindex="-1"></a>customers <span class="sc">|&gt;</span> </span>
<span id="cb35-178"><a href="#cb35-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(customerid <span class="sc">%in%</span> bagel_order_customers) <span class="sc">|&gt;</span> </span>
<span id="cb35-179"><a href="#cb35-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">gsub</span>(<span class="st">" jr.| iii| v| ii| iv | i"</span>, <span class="st">""</span>, <span class="fu">tolower</span>(name)),</span>
<span id="cb35-180"><a href="#cb35-180" aria-hidden="true" tabindex="-1"></a>         <span class="at">last_name =</span> <span class="fu">str_extract</span>(name, <span class="st">"</span><span class="sc">\\</span><span class="st">w+$"</span>), </span>
<span id="cb35-181"><a href="#cb35-181" aria-hidden="true" tabindex="-1"></a>         <span class="at">first_name =</span> <span class="fu">str_extract</span>(name, <span class="st">"^</span><span class="sc">\\</span><span class="st">w+"</span>), </span>
<span id="cb35-182"><a href="#cb35-182" aria-hidden="true" tabindex="-1"></a>         <span class="at">initals =</span> <span class="fu">paste0</span>(<span class="fu">str_sub</span>(first_name, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb35-183"><a href="#cb35-183" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">str_sub</span>(last_name, <span class="dv">1</span>, <span class="dv">1</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb35-184"><a href="#cb35-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(initals <span class="sc">==</span> <span class="st">"jp"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-185"><a href="#cb35-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, phone)</span>
<span id="cb35-186"><a href="#cb35-186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-187"><a href="#cb35-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-188"><a href="#cb35-188" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python</span></span>
<span id="cb35-189"><a href="#cb35-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-192"><a href="#cb35-192" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb35-193"><a href="#cb35-193" aria-hidden="true" tabindex="-1"></a>cust <span class="op">=</span> data[data[<span class="st">"desc"</span>].<span class="bu">str</span>.contains(<span class="st">"bagel"</span>, case <span class="op">=</span> <span class="va">False</span>) <span class="op">&amp;</span> </span>
<span id="cb35-194"><a href="#cb35-194" aria-hidden="true" tabindex="-1"></a>            data[<span class="st">"shipped"</span>].<span class="bu">str</span>.contains(<span class="st">"2017"</span>)]</span>
<span id="cb35-195"><a href="#cb35-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-196"><a href="#cb35-196" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, row <span class="kw">in</span> cust.iterrows():</span>
<span id="cb35-197"><a href="#cb35-197" aria-hidden="true" tabindex="-1"></a>  name <span class="op">=</span> row[<span class="st">'name'</span>]</span>
<span id="cb35-198"><a href="#cb35-198" aria-hidden="true" tabindex="-1"></a>  phone <span class="op">=</span> row[<span class="st">'phone'</span>]</span>
<span id="cb35-199"><a href="#cb35-199" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-200"><a href="#cb35-200" aria-hidden="true" tabindex="-1"></a>  names <span class="op">=</span> (</span>
<span id="cb35-201"><a href="#cb35-201" aria-hidden="true" tabindex="-1"></a>    name</span>
<span id="cb35-202"><a href="#cb35-202" aria-hidden="true" tabindex="-1"></a>      .lower()</span>
<span id="cb35-203"><a href="#cb35-203" aria-hidden="true" tabindex="-1"></a>      .replace(<span class="st">"jr.| iii| v| ii| iv | i"</span>, <span class="st">""</span>)</span>
<span id="cb35-204"><a href="#cb35-204" aria-hidden="true" tabindex="-1"></a>      .split(<span class="st">" "</span>)</span>
<span id="cb35-205"><a href="#cb35-205" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-206"><a href="#cb35-206" aria-hidden="true" tabindex="-1"></a>  initals <span class="op">=</span> names[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">+</span> names[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb35-207"><a href="#cb35-207" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-208"><a href="#cb35-208" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> initals <span class="op">==</span> <span class="st">"jp"</span>:</span>
<span id="cb35-209"><a href="#cb35-209" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="ss">f"Solution:</span><span class="ch">\n</span><span class="ss">Name: </span><span class="sc">{</span>name<span class="sc">}</span><span class="ch">\n</span><span class="ss">Phone: </span><span class="sc">{</span>phone<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb35-210"><a href="#cb35-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-211"><a href="#cb35-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-212"><a href="#cb35-212" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-213"><a href="#cb35-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-214"><a href="#cb35-214" aria-hidden="true" tabindex="-1"></a>::: {.callout collapse="true"}</span>
<span id="cb35-215"><a href="#cb35-215" aria-hidden="true" tabindex="-1"></a><span class="fu">### Day  3 - The Neighbor</span></span>
<span id="cb35-216"><a href="#cb35-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-217"><a href="#cb35-217" aria-hidden="true" tabindex="-1"></a>Sarah and the investigator were very impressed with your data skills, as you were able to figure out the phone number of the contractor. They called up the cleaning contractor straight away and asked about the rug.</span>
<span id="cb35-218"><a href="#cb35-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-219"><a href="#cb35-219" aria-hidden="true" tabindex="-1"></a>“Oh, yeah, I did some special projects for them a few years ago. I remember that rug unfortunately. I managed to clean one section, which revealed a giant spider that startled me whenever I tried to work on it.</span>
<span id="cb35-220"><a href="#cb35-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-221"><a href="#cb35-221" aria-hidden="true" tabindex="-1"></a>“I already had a fear of spiders before this, but this spider was so realistic that I had a hard time making any more progress. I kept expecting the cleaners would call for the rug, but they never did. I felt so bad about it, I couldn’t face them, and of course they never gave me another project.</span>
<span id="cb35-222"><a href="#cb35-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-223"><a href="#cb35-223" aria-hidden="true" tabindex="-1"></a>“At last I couldn’t deal with the rug taking up my whole bathtub, so I gave it to this guy who lived in my neighborhood. He said that he was naturally intuitive because he was a Cancer born in the year of the Rabbit, so maybe he was able to clean it.</span>
<span id="cb35-224"><a href="#cb35-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-225"><a href="#cb35-225" aria-hidden="true" tabindex="-1"></a>“I don’t remember his name. Last time I saw him, he was leaving the subway and carrying a bag from Noah’s. I swore I saw a spider on his hat.”</span>
<span id="cb35-226"><a href="#cb35-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-227"><a href="#cb35-227" aria-hidden="true" tabindex="-1"></a>Can you find the phone number of the person that the contractor gave the rug to?</span>
<span id="cb35-228"><a href="#cb35-228" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-229"><a href="#cb35-229" aria-hidden="true" tabindex="-1"></a>::: panel-tabset </span>
<span id="cb35-230"><a href="#cb35-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-231"><a href="#cb35-231" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb35-232"><a href="#cb35-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-235"><a href="#cb35-235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-236"><a href="#cb35-236" aria-hidden="true" tabindex="-1"></a>rabbit_years <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1939</span>, <span class="dv">1951</span>, <span class="dv">1963</span>, <span class="dv">1975</span>, <span class="dv">1987</span>, <span class="dv">1999</span>)</span>
<span id="cb35-237"><a href="#cb35-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-238"><a href="#cb35-238" aria-hidden="true" tabindex="-1"></a>neighborhood <span class="ot">=</span> customers <span class="sc">|&gt;</span> </span>
<span id="cb35-239"><a href="#cb35-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(phone <span class="sc">==</span> <span class="st">"332-274-4185"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-240"><a href="#cb35-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(<span class="st">"citystatezip"</span>)</span>
<span id="cb35-241"><a href="#cb35-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-242"><a href="#cb35-242" aria-hidden="true" tabindex="-1"></a>customers <span class="sc">|&gt;</span> </span>
<span id="cb35-243"><a href="#cb35-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(birthdate), </span>
<span id="cb35-244"><a href="#cb35-244" aria-hidden="true" tabindex="-1"></a>         <span class="at">month =</span> lubridate<span class="sc">::</span><span class="fu">month</span>(birthdate), </span>
<span id="cb35-245"><a href="#cb35-245" aria-hidden="true" tabindex="-1"></a>         <span class="at">day =</span> lubridate<span class="sc">::</span><span class="fu">day</span>(birthdate)) <span class="sc">|&gt;</span> </span>
<span id="cb35-246"><a href="#cb35-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> rabbit_years, </span>
<span id="cb35-247"><a href="#cb35-247" aria-hidden="true" tabindex="-1"></a>         month <span class="sc">==</span> <span class="dv">6</span> <span class="sc">&amp;</span> day <span class="sc">&gt;=</span> <span class="dv">21</span> <span class="sc">|</span> month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">&amp;</span> day <span class="sc">&lt;=</span> <span class="dv">22</span>, </span>
<span id="cb35-248"><a href="#cb35-248" aria-hidden="true" tabindex="-1"></a>         citystatezip <span class="sc">==</span> neighborhood) <span class="sc">|&gt;</span> </span>
<span id="cb35-249"><a href="#cb35-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, phone)</span>
<span id="cb35-250"><a href="#cb35-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-251"><a href="#cb35-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-252"><a href="#cb35-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-253"><a href="#cb35-253" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python </span></span>
<span id="cb35-254"><a href="#cb35-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-257"><a href="#cb35-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb35-258"><a href="#cb35-258" aria-hidden="true" tabindex="-1"></a>rabbit_years <span class="op">=</span> [<span class="dv">1939</span>, <span class="dv">1951</span>, <span class="dv">1963</span>, <span class="dv">1975</span>, <span class="dv">1987</span>, <span class="dv">1999</span>]</span>
<span id="cb35-259"><a href="#cb35-259" aria-hidden="true" tabindex="-1"></a>neighborhood <span class="op">=</span> customers[customers[<span class="st">"phone"</span>] <span class="op">==</span> <span class="st">"332-274-4185"</span>][<span class="st">"citystatezip"</span>].iloc[<span class="dv">0</span>]</span>
<span id="cb35-260"><a href="#cb35-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-261"><a href="#cb35-261" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"birthdate"</span>] <span class="op">=</span> pd.to_datetime(data[<span class="st">"birthdate"</span>])</span>
<span id="cb35-262"><a href="#cb35-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-263"><a href="#cb35-263" aria-hidden="true" tabindex="-1"></a>birth_month <span class="op">=</span> data[<span class="st">"birthdate"</span>].dt.month</span>
<span id="cb35-264"><a href="#cb35-264" aria-hidden="true" tabindex="-1"></a>birth_day <span class="op">=</span> data[<span class="st">"birthdate"</span>].dt.day</span>
<span id="cb35-265"><a href="#cb35-265" aria-hidden="true" tabindex="-1"></a>birth_year <span class="op">=</span> data[<span class="st">"birthdate"</span>].dt.year</span>
<span id="cb35-266"><a href="#cb35-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-267"><a href="#cb35-267" aria-hidden="true" tabindex="-1"></a>june_f <span class="op">=</span> (birth_month <span class="op">==</span> <span class="dv">6</span>) <span class="op">&amp;</span> (birth_day <span class="op">&gt;=</span> <span class="dv">21</span>)</span>
<span id="cb35-268"><a href="#cb35-268" aria-hidden="true" tabindex="-1"></a>july_f <span class="op">=</span> (birth_month <span class="op">==</span> <span class="dv">7</span>) <span class="op">&amp;</span> (birth_day <span class="op">&lt;=</span> <span class="dv">22</span>)</span>
<span id="cb35-269"><a href="#cb35-269" aria-hidden="true" tabindex="-1"></a>rabbit_year_f <span class="op">=</span> birth_year.isin(rabbit_years)</span>
<span id="cb35-270"><a href="#cb35-270" aria-hidden="true" tabindex="-1"></a>neighborhood_f <span class="op">=</span> data[<span class="st">"citystatezip"</span>] <span class="op">==</span> neighborhood</span>
<span id="cb35-271"><a href="#cb35-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-272"><a href="#cb35-272" aria-hidden="true" tabindex="-1"></a>conditions <span class="op">=</span> (june_f <span class="op">|</span> july_f) <span class="op">&amp;</span> rabbit_year_f <span class="op">&amp;</span> neighborhood_f</span>
<span id="cb35-273"><a href="#cb35-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-274"><a href="#cb35-274" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the filter</span></span>
<span id="cb35-275"><a href="#cb35-275" aria-hidden="true" tabindex="-1"></a>data[conditions][[<span class="st">"name"</span>, <span class="st">"phone"</span>]]</span>
<span id="cb35-276"><a href="#cb35-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-277"><a href="#cb35-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-278"><a href="#cb35-278" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb35-279"><a href="#cb35-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-280"><a href="#cb35-280" aria-hidden="true" tabindex="-1"></a>::: {.callout collapse="true"}</span>
<span id="cb35-281"><a href="#cb35-281" aria-hidden="true" tabindex="-1"></a><span class="fu">### Day  4 - The Early Bird</span></span>
<span id="cb35-282"><a href="#cb35-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-283"><a href="#cb35-283" aria-hidden="true" tabindex="-1"></a>The investigator called the phone number you found and left a message, and a man soon called back:</span>
<span id="cb35-284"><a href="#cb35-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-285"><a href="#cb35-285" aria-hidden="true" tabindex="-1"></a>“Wow, that was years ago! It was quite an elegant tapestry.</span>
<span id="cb35-286"><a href="#cb35-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-287"><a href="#cb35-287" aria-hidden="true" tabindex="-1"></a>“It took a lot of patience, but I did manage to get the dirt out of one section, which uncovered a superb owl. I put it up on my wall, and sometimes at night I swear I could hear the owl hooting.</span>
<span id="cb35-288"><a href="#cb35-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-289"><a href="#cb35-289" aria-hidden="true" tabindex="-1"></a>“A few weeks later my bike chain broke on the way home, and I needed to get it fixed before work the next day. Thankfully, this woman I met on Tinder came over at 5am with her bike chain repair kit and some pastries from Noah’s. Apparently she liked to get up before dawn and claim the first pastries that came out of the oven.</span>
<span id="cb35-290"><a href="#cb35-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-291"><a href="#cb35-291" aria-hidden="true" tabindex="-1"></a>“I didn’t have any money or I would’ve paid her for her trouble. She really liked the tapestry, though, so I wound up giving it to her.</span>
<span id="cb35-292"><a href="#cb35-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-293"><a href="#cb35-293" aria-hidden="true" tabindex="-1"></a>“I don’t remember her name or anything else about her.”</span>
<span id="cb35-294"><a href="#cb35-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-295"><a href="#cb35-295" aria-hidden="true" tabindex="-1"></a>Can you find the bicycle fixer’s phone number?</span>
<span id="cb35-296"><a href="#cb35-296" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-297"><a href="#cb35-297" aria-hidden="true" tabindex="-1"></a>::: panel-tabset </span>
<span id="cb35-298"><a href="#cb35-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-299"><a href="#cb35-299" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb35-300"><a href="#cb35-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-303"><a href="#cb35-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-304"><a href="#cb35-304" aria-hidden="true" tabindex="-1"></a>bakery_skus <span class="ot">=</span> products <span class="sc">|&gt;</span> </span>
<span id="cb35-305"><a href="#cb35-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"bky"</span>, <span class="fu">tolower</span>(sku))) <span class="sc">|&gt;</span> </span>
<span id="cb35-306"><a href="#cb35-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"bagel"</span>, <span class="fu">tolower</span>(desc)))</span>
<span id="cb35-307"><a href="#cb35-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-308"><a href="#cb35-308" aria-hidden="true" tabindex="-1"></a>bakery_order_items <span class="ot">=</span> orders_items <span class="sc">|&gt;</span> </span>
<span id="cb35-309"><a href="#cb35-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sku <span class="sc">%in%</span> bakery_skus<span class="sc">$</span>sku, </span>
<span id="cb35-310"><a href="#cb35-310" aria-hidden="true" tabindex="-1"></a>         qty <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-311"><a href="#cb35-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(<span class="st">"orderid"</span>)</span>
<span id="cb35-312"><a href="#cb35-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-313"><a href="#cb35-313" aria-hidden="true" tabindex="-1"></a>bakery_orders_customers <span class="ot">=</span> orders <span class="sc">|&gt;</span> </span>
<span id="cb35-314"><a href="#cb35-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(orderid <span class="sc">%in%</span> bakery_order_items, </span>
<span id="cb35-315"><a href="#cb35-315" aria-hidden="true" tabindex="-1"></a>         lubridate<span class="sc">::</span><span class="fu">hour</span>(shipped) <span class="sc">&lt;</span> <span class="dv">5</span>,</span>
<span id="cb35-316"><a href="#cb35-316" aria-hidden="true" tabindex="-1"></a>         ordered <span class="sc">==</span> shipped)</span>
<span id="cb35-317"><a href="#cb35-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-318"><a href="#cb35-318" aria-hidden="true" tabindex="-1"></a>customers <span class="sc">|&gt;</span> </span>
<span id="cb35-319"><a href="#cb35-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(customerid <span class="sc">%in%</span> bakery_orders_customers<span class="sc">$</span>customerid) <span class="sc">|&gt;</span> </span>
<span id="cb35-320"><a href="#cb35-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, phone)</span>
<span id="cb35-321"><a href="#cb35-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-322"><a href="#cb35-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-323"><a href="#cb35-323" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python</span></span>
<span id="cb35-324"><a href="#cb35-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-327"><a href="#cb35-327" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb35-328"><a href="#cb35-328" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"shipped"</span>] <span class="op">=</span> pd.to_datetime(data[<span class="st">"shipped"</span>])</span>
<span id="cb35-329"><a href="#cb35-329" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"ordered"</span>] <span class="op">=</span> pd.to_datetime(data[<span class="st">"ordered"</span>])</span>
<span id="cb35-330"><a href="#cb35-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-331"><a href="#cb35-331" aria-hidden="true" tabindex="-1"></a>sku_f <span class="op">=</span> data[<span class="st">"sku"</span>].<span class="bu">str</span>.contains(<span class="st">"bky"</span>, case<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb35-332"><a href="#cb35-332" aria-hidden="true" tabindex="-1"></a>hour_f <span class="op">=</span> data[<span class="st">"shipped"</span>].dt.hour <span class="op">&lt;</span> <span class="dv">5</span></span>
<span id="cb35-333"><a href="#cb35-333" aria-hidden="true" tabindex="-1"></a>in_store_f <span class="op">=</span> data[<span class="st">"shipped"</span>] <span class="op">==</span> data[<span class="st">"ordered"</span>]</span>
<span id="cb35-334"><a href="#cb35-334" aria-hidden="true" tabindex="-1"></a>qty_f <span class="op">=</span> data[<span class="st">"qty"</span>] <span class="op">&gt;</span> <span class="dv">1</span></span>
<span id="cb35-335"><a href="#cb35-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-336"><a href="#cb35-336" aria-hidden="true" tabindex="-1"></a>conditions <span class="op">=</span> sku_f <span class="op">&amp;</span> hour_f <span class="op">&amp;</span> in_store_f <span class="op">&amp;</span> qty_f</span>
<span id="cb35-337"><a href="#cb35-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-338"><a href="#cb35-338" aria-hidden="true" tabindex="-1"></a>data[conditions][[<span class="st">"name"</span>, <span class="st">"phone"</span>]].drop_duplicates()</span>
<span id="cb35-339"><a href="#cb35-339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-340"><a href="#cb35-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-341"><a href="#cb35-341" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb35-342"><a href="#cb35-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-343"><a href="#cb35-343" aria-hidden="true" tabindex="-1"></a>::: {.callout collapse="true"}</span>
<span id="cb35-344"><a href="#cb35-344" aria-hidden="true" tabindex="-1"></a><span class="fu">### Day  5 - The Cat Lady</span></span>
<span id="cb35-345"><a href="#cb35-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-346"><a href="#cb35-346" aria-hidden="true" tabindex="-1"></a>“Yes, I did have that tapestry for a little bit. I even cleaned a blotchy section that turned out to be a friendly koala.</span>
<span id="cb35-347"><a href="#cb35-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-348"><a href="#cb35-348" aria-hidden="true" tabindex="-1"></a>“But it was still really dirty, so when I was going through a Marie Kondo phase, I decided it wasn’t sparking joy anymore.</span>
<span id="cb35-349"><a href="#cb35-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-350"><a href="#cb35-350" aria-hidden="true" tabindex="-1"></a>“I listed it on Freecycle, and a woman in Staten Island came to pick it up. She was wearing a ‘Noah’s Market’ sweatshirt, and it was just covered in cat hair. When I suggested that a clowder of cats might ruin such a fine tapestry, she looked at me funny. She said “I only have ten or eleven cats, and anyway they are getting quite old now, so I doubt they’d care about some old rug.”</span>
<span id="cb35-351"><a href="#cb35-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-352"><a href="#cb35-352" aria-hidden="true" tabindex="-1"></a>“It took her 20 minutes to stuff the tapestry into some plastic bags she brought because it was raining. I spent the evening cleaning my apartment.”</span>
<span id="cb35-353"><a href="#cb35-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-354"><a href="#cb35-354" aria-hidden="true" tabindex="-1"></a>What’s the phone number of the woman from Freecycle?</span>
<span id="cb35-355"><a href="#cb35-355" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-356"><a href="#cb35-356" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb35-357"><a href="#cb35-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-358"><a href="#cb35-358" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb35-359"><a href="#cb35-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-362"><a href="#cb35-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-363"><a href="#cb35-363" aria-hidden="true" tabindex="-1"></a>old_cat_food <span class="ot">=</span> products <span class="sc">|&gt;</span> </span>
<span id="cb35-364"><a href="#cb35-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"senior cat"</span>, <span class="fu">tolower</span>(desc))) <span class="sc">|&gt;</span> </span>
<span id="cb35-365"><a href="#cb35-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(<span class="st">"sku"</span>)</span>
<span id="cb35-366"><a href="#cb35-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-367"><a href="#cb35-367" aria-hidden="true" tabindex="-1"></a>cat_order_items <span class="ot">=</span> orders_items <span class="sc">|&gt;</span> </span>
<span id="cb35-368"><a href="#cb35-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sku <span class="sc">%in%</span> old_cat_food, </span>
<span id="cb35-369"><a href="#cb35-369" aria-hidden="true" tabindex="-1"></a>         qty <span class="sc">==</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-370"><a href="#cb35-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(<span class="st">"orderid"</span>)</span>
<span id="cb35-371"><a href="#cb35-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-372"><a href="#cb35-372" aria-hidden="true" tabindex="-1"></a>orders <span class="sc">|&gt;</span> </span>
<span id="cb35-373"><a href="#cb35-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(orderid <span class="sc">%in%</span> cat_order_items) <span class="sc">|&gt;</span> </span>
<span id="cb35-374"><a href="#cb35-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(customers, <span class="at">by =</span> <span class="st">"customerid"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-375"><a href="#cb35-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, phone) <span class="sc">|&gt;</span> </span>
<span id="cb35-376"><a href="#cb35-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb35-377"><a href="#cb35-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-378"><a href="#cb35-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-379"><a href="#cb35-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-380"><a href="#cb35-380" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python</span></span>
<span id="cb35-381"><a href="#cb35-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-384"><a href="#cb35-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb35-385"><a href="#cb35-385" aria-hidden="true" tabindex="-1"></a>cat_desc <span class="op">=</span> data[<span class="st">"desc"</span>].<span class="bu">str</span>.contains(<span class="st">"senior cat"</span>, case<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb35-386"><a href="#cb35-386" aria-hidden="true" tabindex="-1"></a>cat_qty <span class="op">=</span> data[<span class="st">"qty"</span>] <span class="op">==</span> <span class="dv">10</span></span>
<span id="cb35-387"><a href="#cb35-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-388"><a href="#cb35-388" aria-hidden="true" tabindex="-1"></a>data[cat_desc <span class="op">&amp;</span> cat_qty][[<span class="st">"name"</span>, <span class="st">"phone"</span>]].drop_duplicates()</span>
<span id="cb35-389"><a href="#cb35-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-390"><a href="#cb35-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-391"><a href="#cb35-391" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-392"><a href="#cb35-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-393"><a href="#cb35-393" aria-hidden="true" tabindex="-1"></a>::: {.callout collapse="true"}</span>
<span id="cb35-394"><a href="#cb35-394" aria-hidden="true" tabindex="-1"></a><span class="fu">### Day  6 - The Bargain Hunter</span></span>
<span id="cb35-395"><a href="#cb35-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-396"><a href="#cb35-396" aria-hidden="true" tabindex="-1"></a>“Why yes, I did have that rug for a little while in my living room! My cats can’t see a thing but they sure chased after the squirrel on it like it was dancing in front of their noses.</span>
<span id="cb35-397"><a href="#cb35-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-398"><a href="#cb35-398" aria-hidden="true" tabindex="-1"></a>“It was a nice rug and they were surely going to ruin it, so I gave it to my cousin, who was moving into a new place that had wood floors.</span>
<span id="cb35-399"><a href="#cb35-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-400"><a href="#cb35-400" aria-hidden="true" tabindex="-1"></a>“She refused to buy a new rug for herself–she said they were way too expensive. She’s always been very frugal, and she clips every coupon and shops every sale at Noah’s Market. In fact I like to tease her that Noah actually loses money whenever she comes in the store.</span>
<span id="cb35-401"><a href="#cb35-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-402"><a href="#cb35-402" aria-hidden="true" tabindex="-1"></a>“I think she’s been taking it too far lately though. Once the subway fare increased, she stopped coming to visit me. And she’s really slow to respond to my texts. I hope she remembers to invite me to the family reunion next year.”</span>
<span id="cb35-403"><a href="#cb35-403" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-404"><a href="#cb35-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-405"><a href="#cb35-405" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb35-406"><a href="#cb35-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-407"><a href="#cb35-407" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb35-408"><a href="#cb35-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-411"><a href="#cb35-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-412"><a href="#cb35-412" aria-hidden="true" tabindex="-1"></a><span class="co"># check which prices are offered below wholesale cost </span></span>
<span id="cb35-413"><a href="#cb35-413" aria-hidden="true" tabindex="-1"></a>orders_below_cost <span class="ot">=</span> orders_items <span class="sc">|&gt;</span> </span>
<span id="cb35-414"><a href="#cb35-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(products <span class="sc">|&gt;</span> <span class="fu">select</span>(wholesale_cost, sku), </span>
<span id="cb35-415"><a href="#cb35-415" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"sku"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-416"><a href="#cb35-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sale =</span> unit_price <span class="sc">&lt;</span> wholesale_cost) <span class="sc">|&gt;</span> </span>
<span id="cb35-417"><a href="#cb35-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sale) <span class="sc">|&gt;</span> </span>
<span id="cb35-418"><a href="#cb35-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(orderid)</span>
<span id="cb35-419"><a href="#cb35-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-420"><a href="#cb35-420" aria-hidden="true" tabindex="-1"></a>orders <span class="sc">|&gt;</span> </span>
<span id="cb35-421"><a href="#cb35-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(orderid <span class="sc">%in%</span> orders_below_cost) <span class="sc">|&gt;</span></span>
<span id="cb35-422"><a href="#cb35-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(customerid) <span class="sc">|&gt;</span> </span>
<span id="cb35-423"><a href="#cb35-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">num_purchases =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span></span>
<span id="cb35-424"><a href="#cb35-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(num_purchases)) <span class="sc">|&gt;</span></span>
<span id="cb35-425"><a href="#cb35-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(customers <span class="sc">|&gt;</span> <span class="fu">select</span>(customerid, name, phone), <span class="at">by =</span> <span class="st">"customerid"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-426"><a href="#cb35-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_purchases <span class="sc">==</span> <span class="fu">max</span>(num_purchases)) <span class="sc">|&gt;</span> </span>
<span id="cb35-427"><a href="#cb35-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, phone)</span>
<span id="cb35-428"><a href="#cb35-428" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-429"><a href="#cb35-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-430"><a href="#cb35-430" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python </span></span>
<span id="cb35-431"><a href="#cb35-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-434"><a href="#cb35-434" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb35-435"><a href="#cb35-435" aria-hidden="true" tabindex="-1"></a>below_cost <span class="op">=</span> data[<span class="st">"unit_price"</span>] <span class="op">&lt;</span> data[<span class="st">"wholesale_cost"</span>]</span>
<span id="cb35-436"><a href="#cb35-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-437"><a href="#cb35-437" aria-hidden="true" tabindex="-1"></a>counts <span class="op">=</span> (</span>
<span id="cb35-438"><a href="#cb35-438" aria-hidden="true" tabindex="-1"></a>  data[below_cost]</span>
<span id="cb35-439"><a href="#cb35-439" aria-hidden="true" tabindex="-1"></a>  .groupby([<span class="st">"name"</span>, <span class="st">"phone"</span>])</span>
<span id="cb35-440"><a href="#cb35-440" aria-hidden="true" tabindex="-1"></a>  .agg(n_below_cost <span class="op">=</span> pd.NamedAgg(column<span class="op">=</span><span class="st">"orderid"</span>, aggfunc<span class="op">=</span><span class="st">"nunique"</span>))</span>
<span id="cb35-441"><a href="#cb35-441" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-442"><a href="#cb35-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-443"><a href="#cb35-443" aria-hidden="true" tabindex="-1"></a>counts[counts[<span class="st">"n_below_cost"</span>] <span class="op">==</span> counts[<span class="st">"n_below_cost"</span>].<span class="bu">max</span>()]</span>
<span id="cb35-444"><a href="#cb35-444" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-445"><a href="#cb35-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-446"><a href="#cb35-446" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-447"><a href="#cb35-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-448"><a href="#cb35-448" aria-hidden="true" tabindex="-1"></a>::: {.callout collapse="true"}</span>
<span id="cb35-449"><a href="#cb35-449" aria-hidden="true" tabindex="-1"></a><span class="fu">### Day  7 - The Meet Cute</span></span>
<span id="cb35-450"><a href="#cb35-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-451"><a href="#cb35-451" aria-hidden="true" tabindex="-1"></a>“Oh that tapestry, with the colorful toucan on it! I’ll tell you what happened to it.</span>
<span id="cb35-452"><a href="#cb35-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-453"><a href="#cb35-453" aria-hidden="true" tabindex="-1"></a>“One day, I was at Noah’s Market, and I was just about to leave when someone behind me said ‘Miss! You dropped something!’</span>
<span id="cb35-454"><a href="#cb35-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-455"><a href="#cb35-455" aria-hidden="true" tabindex="-1"></a>“Well I turned around to see this cute guy holding an item I had bought. He said, ‘I got the same thing!’ We laughed about it and wound up swapping items because I wanted the color he got. We had a moment when our eyes met and my heart stopped for a second. I asked him to get some food with me and we spent the rest of the day together.</span>
<span id="cb35-456"><a href="#cb35-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-457"><a href="#cb35-457" aria-hidden="true" tabindex="-1"></a>“Before long I moved into his place, but the romance faded quickly, as he wasn’t the prince I imagined. I left abruptly one night, forgetting the tapestry on his wall. But by then, it symbolized our love, and I wanted nothing more to do with it. For all I know, he still has it.”</span>
<span id="cb35-458"><a href="#cb35-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-459"><a href="#cb35-459" aria-hidden="true" tabindex="-1"></a>Can you figure out her ex-boyfriend’s phone number?</span>
<span id="cb35-460"><a href="#cb35-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-461"><a href="#cb35-461" aria-hidden="true" tabindex="-1"></a>Can you find her cousin’s phone number?</span>
<span id="cb35-462"><a href="#cb35-462" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-463"><a href="#cb35-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-464"><a href="#cb35-464" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb35-465"><a href="#cb35-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-466"><a href="#cb35-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-467"><a href="#cb35-467" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb35-468"><a href="#cb35-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-471"><a href="#cb35-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-472"><a href="#cb35-472" aria-hidden="true" tabindex="-1"></a>day_6_phone <span class="ot">=</span> <span class="st">"585-838-9161"</span></span>
<span id="cb35-473"><a href="#cb35-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-474"><a href="#cb35-474" aria-hidden="true" tabindex="-1"></a>past_customer <span class="ot">=</span> customers <span class="sc">|&gt;</span> </span>
<span id="cb35-475"><a href="#cb35-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(phone <span class="sc">==</span> day_6_phone) <span class="sc">|&gt;</span> </span>
<span id="cb35-476"><a href="#cb35-476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(customerid)</span>
<span id="cb35-477"><a href="#cb35-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-478"><a href="#cb35-478" aria-hidden="true" tabindex="-1"></a>color_purchases <span class="ot">=</span> products <span class="sc">|&gt;</span> </span>
<span id="cb35-479"><a href="#cb35-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(orders_items <span class="sc">|&gt;</span> <span class="fu">select</span>(orderid, sku), <span class="at">by =</span> <span class="st">"sku"</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-480"><a href="#cb35-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(orders <span class="sc">|&gt;</span> <span class="fu">select</span>(orderid, customerid, </span>
<span id="cb35-481"><a href="#cb35-481" aria-hidden="true" tabindex="-1"></a>                             ordered, shipped), </span>
<span id="cb35-482"><a href="#cb35-482" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"orderid"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-483"><a href="#cb35-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"col"</span>, <span class="fu">tolower</span>(sku)), </span>
<span id="cb35-484"><a href="#cb35-484" aria-hidden="true" tabindex="-1"></a>         ordered <span class="sc">==</span> shipped) <span class="sc">|&gt;</span> </span>
<span id="cb35-485"><a href="#cb35-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">item =</span> <span class="fu">str_extract</span>(desc, <span class="st">"</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">s</span><span class="sc">\\</span><span class="st">w+"</span>), </span>
<span id="cb35-486"><a href="#cb35-486" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="fu">str_extract</span>(desc, <span class="st">"</span><span class="sc">\\</span><span class="st">(</span><span class="sc">\\</span><span class="st">w+</span><span class="sc">\\</span><span class="st">)"</span>), </span>
<span id="cb35-487"><a href="#cb35-487" aria-hidden="true" tabindex="-1"></a>         <span class="at">colour =</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">(|</span><span class="sc">\\</span><span class="st">)"</span>, <span class="st">""</span>, colour))</span>
<span id="cb35-488"><a href="#cb35-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-489"><a href="#cb35-489" aria-hidden="true" tabindex="-1"></a>gf_purchases <span class="ot">=</span> color_purchases <span class="sc">|&gt;</span> </span>
<span id="cb35-490"><a href="#cb35-490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(customerid <span class="sc">==</span> past_customer, </span>
<span id="cb35-491"><a href="#cb35-491" aria-hidden="true" tabindex="-1"></a>         <span class="fu">grepl</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">("</span>, desc)) </span>
<span id="cb35-492"><a href="#cb35-492" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-493"><a href="#cb35-493" aria-hidden="true" tabindex="-1"></a>search_for_purchases <span class="ot">=</span> <span class="cf">function</span>(dat) {</span>
<span id="cb35-494"><a href="#cb35-494" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-495"><a href="#cb35-495" aria-hidden="true" tabindex="-1"></a>  gf_item <span class="ot">=</span> dat<span class="sc">$</span>item</span>
<span id="cb35-496"><a href="#cb35-496" aria-hidden="true" tabindex="-1"></a>  gf_colour <span class="ot">=</span> dat<span class="sc">$</span>colour</span>
<span id="cb35-497"><a href="#cb35-497" aria-hidden="true" tabindex="-1"></a>  gf_time <span class="ot">=</span> dat<span class="sc">$</span>ordered</span>
<span id="cb35-498"><a href="#cb35-498" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-499"><a href="#cb35-499" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">=</span> color_purchases <span class="sc">|&gt;</span> </span>
<span id="cb35-500"><a href="#cb35-500" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(item <span class="sc">==</span> gf_item <span class="sc">&amp;</span> colour <span class="sc">!=</span> gf_colour, </span>
<span id="cb35-501"><a href="#cb35-501" aria-hidden="true" tabindex="-1"></a>           <span class="fu">abs</span>(<span class="fu">difftime</span>(ordered, gf_time, <span class="at">units =</span> <span class="st">"mins"</span>)) <span class="sc">&lt;</span> <span class="dv">10</span>)</span>
<span id="cb35-502"><a href="#cb35-502" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-503"><a href="#cb35-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb35-504"><a href="#cb35-504" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-505"><a href="#cb35-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-506"><a href="#cb35-506" aria-hidden="true" tabindex="-1"></a><span class="co"># loop through girlfriend's purchases</span></span>
<span id="cb35-507"><a href="#cb35-507" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(gf_purchases), <span class="cf">function</span>(i) {</span>
<span id="cb35-508"><a href="#cb35-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">search_for_purchases</span>(gf_purchases[i, ])</span>
<span id="cb35-509"><a href="#cb35-509" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">|&gt;</span> </span>
<span id="cb35-510"><a href="#cb35-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>() <span class="sc">|&gt;</span> </span>
<span id="cb35-511"><a href="#cb35-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(customerid) <span class="sc">|&gt;</span> </span>
<span id="cb35-512"><a href="#cb35-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(customers, <span class="at">by =</span> <span class="st">"customerid"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-513"><a href="#cb35-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(customerid, name, phone)</span>
<span id="cb35-514"><a href="#cb35-514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-515"><a href="#cb35-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-516"><a href="#cb35-516" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python </span></span>
<span id="cb35-517"><a href="#cb35-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-520"><a href="#cb35-520" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb35-521"><a href="#cb35-521" aria-hidden="true" tabindex="-1"></a>day_6_phone <span class="op">=</span> <span class="st">"585-838-9161"</span></span>
<span id="cb35-522"><a href="#cb35-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-523"><a href="#cb35-523" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"color"</span>] <span class="op">=</span> data[<span class="st">"desc"</span>].<span class="bu">str</span>.extract(<span class="vs">r"\((\w+)\)"</span>)</span>
<span id="cb35-524"><a href="#cb35-524" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"item"</span>] <span class="op">=</span> data[<span class="st">"desc"</span>].<span class="bu">str</span>.extract(<span class="vs">r"(\w+\s\w+)"</span>)</span>
<span id="cb35-525"><a href="#cb35-525" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"ordered"</span>] <span class="op">=</span> pd.to_datetime(data[<span class="st">"ordered"</span>])</span>
<span id="cb35-526"><a href="#cb35-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-527"><a href="#cb35-527" aria-hidden="true" tabindex="-1"></a>color_data <span class="op">=</span> data[data[<span class="st">"sku"</span>].<span class="bu">str</span>.contains(<span class="st">"col"</span>, case<span class="op">=</span><span class="va">False</span>)]</span>
<span id="cb35-528"><a href="#cb35-528" aria-hidden="true" tabindex="-1"></a>gf_items <span class="op">=</span> color_data[color_data[<span class="st">"phone"</span>] <span class="op">==</span> day_6_phone]</span>
<span id="cb35-529"><a href="#cb35-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-530"><a href="#cb35-530" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> color, item, time <span class="kw">in</span> <span class="bu">zip</span>(gf_items[<span class="st">"color"</span>], </span>
<span id="cb35-531"><a href="#cb35-531" aria-hidden="true" tabindex="-1"></a>                             gf_items[<span class="st">"item"</span>], </span>
<span id="cb35-532"><a href="#cb35-532" aria-hidden="true" tabindex="-1"></a>                             gf_items[<span class="st">"ordered"</span>]):</span>
<span id="cb35-533"><a href="#cb35-533" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-534"><a href="#cb35-534" aria-hidden="true" tabindex="-1"></a>    time_delta <span class="op">=</span> color_data[<span class="st">"ordered"</span>] <span class="op">-</span> time</span>
<span id="cb35-535"><a href="#cb35-535" aria-hidden="true" tabindex="-1"></a>    diff_color <span class="op">=</span> color_data[<span class="st">"color"</span>] <span class="op">!=</span> color</span>
<span id="cb35-536"><a href="#cb35-536" aria-hidden="true" tabindex="-1"></a>    same_item <span class="op">=</span> color_data[<span class="st">"item"</span>] <span class="op">==</span> item</span>
<span id="cb35-537"><a href="#cb35-537" aria-hidden="true" tabindex="-1"></a>    same_time <span class="op">=</span> <span class="bu">abs</span>(time_delta) <span class="op">&lt;</span> pd.Timedelta(<span class="st">"10 minutes"</span>)</span>
<span id="cb35-538"><a href="#cb35-538" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-539"><a href="#cb35-539" aria-hidden="true" tabindex="-1"></a>    candidate <span class="op">=</span> same_time <span class="op">&amp;</span> same_item <span class="op">&amp;</span> diff_color</span>
<span id="cb35-540"><a href="#cb35-540" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-541"><a href="#cb35-541" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> candidate.<span class="bu">any</span>():</span>
<span id="cb35-542"><a href="#cb35-542" aria-hidden="true" tabindex="-1"></a>      color_data[candidate][[<span class="st">"name"</span>, <span class="st">"phone"</span>]].drop_duplicates()</span>
<span id="cb35-543"><a href="#cb35-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-544"><a href="#cb35-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-545"><a href="#cb35-545" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-546"><a href="#cb35-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-547"><a href="#cb35-547" aria-hidden="true" tabindex="-1"></a>::: {.callout collapse="true"}</span>
<span id="cb35-548"><a href="#cb35-548" aria-hidden="true" tabindex="-1"></a><span class="fu">### Day  8 - The Collector</span></span>
<span id="cb35-549"><a href="#cb35-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-550"><a href="#cb35-550" aria-hidden="true" tabindex="-1"></a>“Oh that damned woman! She moved in, clogged my bathtub, left her coupons all over the kitchen, and then just vanished one night without leaving so much as a note.</span>
<span id="cb35-551"><a href="#cb35-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-552"><a href="#cb35-552" aria-hidden="true" tabindex="-1"></a>Except she did leave behind that nasty carpet. I spent months cleaning one corner, only to discover a snake hiding in the branches! I knew then that she was never coming back, and I had to get it out of my sight.</span>
<span id="cb35-553"><a href="#cb35-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-554"><a href="#cb35-554" aria-hidden="true" tabindex="-1"></a>“Well, I don’t have any storage here, and it didn’t seem right to sell it, so I gave it to my sister. She wound up getting a newer and more expensive carpet, so she gave it to an acquaintance of hers who collects all sorts of junk. Apparently he owns an entire set of Noah’s collectibles! He probably still has the carpet, even.</span>
<span id="cb35-555"><a href="#cb35-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-556"><a href="#cb35-556" aria-hidden="true" tabindex="-1"></a>“My sister is away for the holidays, but I can have her call you in a few weeks.”</span>
<span id="cb35-557"><a href="#cb35-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-558"><a href="#cb35-558" aria-hidden="true" tabindex="-1"></a>The family dinner is tonight! Can you find the collector’s phone number in time?</span>
<span id="cb35-559"><a href="#cb35-559" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-560"><a href="#cb35-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-561"><a href="#cb35-561" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb35-562"><a href="#cb35-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-563"><a href="#cb35-563" aria-hidden="true" tabindex="-1"></a><span class="fu">### R</span></span>
<span id="cb35-564"><a href="#cb35-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-567"><a href="#cb35-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-568"><a href="#cb35-568" aria-hidden="true" tabindex="-1"></a><span class="co"># find customer with the most collectible (col) purchases</span></span>
<span id="cb35-569"><a href="#cb35-569" aria-hidden="true" tabindex="-1"></a>products <span class="sc">|&gt;</span> </span>
<span id="cb35-570"><a href="#cb35-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"col"</span>, <span class="fu">tolower</span>(sku))) <span class="sc">|&gt;</span> </span>
<span id="cb35-571"><a href="#cb35-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(orders_items <span class="sc">|&gt;</span> <span class="fu">select</span>(orderid, sku), <span class="at">by =</span> <span class="st">"sku"</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-572"><a href="#cb35-572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(orders <span class="sc">|&gt;</span> <span class="fu">select</span>(orderid, customerid), <span class="at">by =</span> <span class="st">"orderid"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-573"><a href="#cb35-573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(customerid) <span class="sc">|&gt;</span> </span>
<span id="cb35-574"><a href="#cb35-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="sc">|&gt;</span> </span>
<span id="cb35-575"><a href="#cb35-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(customers <span class="sc">|&gt;</span> <span class="fu">select</span>(customerid, name, phone), <span class="at">by =</span> <span class="st">"customerid"</span>) <span class="sc">|&gt;</span></span>
<span id="cb35-576"><a href="#cb35-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb35-577"><a href="#cb35-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">==</span> <span class="fu">max</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb35-578"><a href="#cb35-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, phone)</span>
<span id="cb35-579"><a href="#cb35-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-580"><a href="#cb35-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-581"><a href="#cb35-581" aria-hidden="true" tabindex="-1"></a><span class="fu">### Python </span></span>
<span id="cb35-582"><a href="#cb35-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-585"><a href="#cb35-585" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb35-586"><a href="#cb35-586" aria-hidden="true" tabindex="-1"></a>collectables <span class="op">=</span> data[data[<span class="st">"sku"</span>].<span class="bu">str</span>.contains(<span class="st">"col"</span>, case<span class="op">=</span><span class="va">False</span>)]</span>
<span id="cb35-587"><a href="#cb35-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-588"><a href="#cb35-588" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb35-589"><a href="#cb35-589" aria-hidden="true" tabindex="-1"></a>    collectables</span>
<span id="cb35-590"><a href="#cb35-590" aria-hidden="true" tabindex="-1"></a>    .groupby([<span class="st">"name"</span>, <span class="st">"phone"</span>])</span>
<span id="cb35-591"><a href="#cb35-591" aria-hidden="true" tabindex="-1"></a>    .agg(n_collectables<span class="op">=</span>pd.NamedAgg(column<span class="op">=</span><span class="st">"orderid"</span>, aggfunc<span class="op">=</span><span class="st">"nunique"</span>))</span>
<span id="cb35-592"><a href="#cb35-592" aria-hidden="true" tabindex="-1"></a>    .sort_values(<span class="st">"n_collectables"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb35-593"><a href="#cb35-593" aria-hidden="true" tabindex="-1"></a>    .head(<span class="dv">1</span>)</span>
<span id="cb35-594"><a href="#cb35-594" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-595"><a href="#cb35-595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb35-596"><a href="#cb35-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-597"><a href="#cb35-597" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb35-598"><a href="#cb35-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-599"><a href="#cb35-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-600"><a href="#cb35-600" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ## My solve statistics  --&gt;</span></span>
<span id="cb35-601"><a href="#cb35-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-602"><a href="#cb35-602" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- I enjoyed working through the puzzles. While there is meant to be an increase in difficulty each day, I found day 7 to be by far the most difficult. The rest of the days I found the biggest challenge finding the key clue within the puzzle prompt.  --&gt;</span></span>
<span id="cb35-603"><a href="#cb35-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-604"><a href="#cb35-604" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | Puzzle | Solve Time | # Attempts | --&gt;</span></span>
<span id="cb35-605"><a href="#cb35-605" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | :---: | :---: | :---: |  --&gt;</span></span>
<span id="cb35-606"><a href="#cb35-606" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | 0 |  39 seconds | 2 | --&gt;</span></span>
<span id="cb35-607"><a href="#cb35-607" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | 1 |  13 minutes | 2 | --&gt;</span></span>
<span id="cb35-608"><a href="#cb35-608" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | 2 | 10 minutes | 1 |  --&gt;</span></span>
<span id="cb35-609"><a href="#cb35-609" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | 3 |  13 minutes | 1 | --&gt;</span></span>
<span id="cb35-610"><a href="#cb35-610" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | 4 |  14 minutes | 1 |  --&gt;</span></span>
<span id="cb35-611"><a href="#cb35-611" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | 5 |  13 minutes | 1 | --&gt;</span></span>
<span id="cb35-612"><a href="#cb35-612" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | 6 |  13 minutes | 1 | --&gt;</span></span>
<span id="cb35-613"><a href="#cb35-613" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | 7 |  70 minutes | 2 | --&gt;</span></span>
<span id="cb35-614"><a href="#cb35-614" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- | 8 |  4 minutes | 1 | --&gt;</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© Copyright 2023 Jordan Hutchings. This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>